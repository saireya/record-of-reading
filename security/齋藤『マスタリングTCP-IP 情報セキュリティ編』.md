# 齋藤[ 『マスタリングTCP-IP 情報セキュリティ編』 ](urn:isbn:4274069214)

## 第1章 情報セキュリティ概論
### セキュリティの分類(p.2-3)
- 物理セキュリティ: ITインフラ周りのセキュリティ
- 論理セキュリティ: それ以外
	- システムセキュリティ
	- 人的セキュリティ
- セキュリティの性質(p.3-4): **機密性**・**完全性**・**可用性**
- セキュリティ対策
	- 脅威への対策: *予防*・*抑止*・*検知*・*回復*
	- セキュリティ*リスク*の観点からの対策: リスクの*低減*・*保有*・*回避*・*移転*

## 第2章 暗号
- 暗号化(encrypt): **平文** → **暗号文** (by 暗号化鍵$k_e$)
- 復号(decrypt): **暗号文** → **平文** (by 復号鍵$k_d$)

### **共通鍵暗号**: $k_e = k_d (= k)$ (p.35-48)
- *ブロック暗号化*: ブロック単位で暗号化
	- e.g. DES, Triple-DES, AES(Rijndael)
- *ストリーム暗号化*: 乱数を使い、平文をbit単位で暗号化
	- e.g. RC4
- *パディング*: ブロック長に足りない部分にデータを埋め込む。e.g. PKCS#5
- ブロックチェイニング: 前のブロックの暗号化処理を次のブロックの暗号化に使用
	- ECB: 何もしない(ブロックごとにバラバラ)
	- CBC: 前のブロック(or初期化ベクトル)とのXORをとる
	- OFB: 初期化ベクトルを何度も暗号化したものとのXORをとる
	- CTR: 初期化ベクトルではなくカウンタを用いる

### **公開鍵暗号**: $k_e \ne k_d$ (p.49-52)
$k_e$: *公開鍵*, $k_d$: *秘密鍵*
- $k_e$から$k_d$を求めるのは困難(逆は可能)
- e.g. *RSA*, *El-Gamal暗号*, *楕円曲線暗号*
- 電子署名用には、El-Gamal暗号を用いた*DSA*や、楕円曲線暗号を用いたECDSAが用いられる
- RSAのアルゴリズム
	0. 素数$p, q$を選ぶ
	0. $n := pq$($n$の長さが鍵の長さ)
	0. $(p-1)(q-1)$と互いに素な自然数$e$を選ぶ
	0. $ed \equiv 1 (\mod (p-1)(q-1))$となる自然数$d$を選ぶ
	0. $(e,n)$を公開鍵として公開、$d$を秘密鍵として保存
- RSAの暗号化
	- 暗号化$C := M^e \mod n$
	- 復号$M := C^d \mod n$
- **ハイブリッド暗号**: 共通鍵を公開鍵暗号で暗号化
	- 公開鍵暗号は共通鍵暗号より遅いことへの折衷案

### *Diffie-Hellman鍵共有アルゴリズム* (p.52-54)
盗聴されうる通信路でAとBが暗号化鍵を交換する手法
0. 素数$p$と$p$の原始根$g$を交換する($p, g$は盗聴されても良い)
0. A,Bはそれぞれ乱数$a, b$を選び、秘密にしておく
0. Aは$n := g^a \mod p$を、Bは$m := g^b \mod p$を公開する
0. Aは受け取った$m$から$k := mg^a = g^{ab} \mod p$を、Bは受け取った$n$から$k := ng^b = g^{ab} \mod p$を得る
0. 得た$k$を暗号化鍵として用いる

実際には、man-in-the-middle攻撃を防ぐため、交換するメッセージに電子署名を付加するなどが必要

### ハッシュ関数 (p.55-58)
hash値(message digest, fingerprint)を求める関数で、次の性質を満たす必要がある
- *一方向性*: 出力から入力を得ることが困難
	- e.g. $H := h(m)$に対し、$m = h^{-1}(H)$を求めるのが困難
- *第2原像計算困難性*: 同じハッシュ値を得られる入力を得ることが困難
	- e.g. ハッシュ値$H$に対し、$m' = h^{-1}(H)$となる$m'$を求めるのが困難
- *衝突困難性*: 同じ出力を与える2つの入力を得るのが困難
	- e.g. $h(m) = h(m')$となる$(m, m')$を求めるのが困難
- e.g. SHA-2, SHA-3
- パスワードのハッシュ値を格納、ファイルの改竄検知、メッセージの改竄検知(MAC)などに利用

### 電子署名 (p.58-59)
*秘密鍵で暗号化*することにより、メッセージの送信者を保証
- 真正性・否認防止性を保証するが、デジタルデータなので原本性は保証されない
	- *真正性*: 間違いなく当人が作成したものか?
	- *否認防止性*: 情報を発信したことを否認できない性質
	- *原本性*: 情報が原本であること

### 安全性 (p.60-61)
- **等価安全性**: 最も効率的な攻撃を行った場合に、解読に必要な計算量
	- $2^x$であれば「*$x$-bit安全性*」という
	- 現時点では70-bit程度の安全性があれば十分とされる
	- 共通鍵暗号であれば、(2進数で)$x$-bitなら$x$-bitの安全性がある($2^x$回の総当たり攻撃で解読可能)
- 独自の暗号アルゴリズムを*用いてはならない*


## 第3章 認証
- **認証**(authentication): ITシステムが「誰か?or何か?」を正しく特定する技術 (p.68-81)
	- *知識*による認証
		- e.g. パスワード, パスフレーズ, PIN(暗証番号)
		- Shannonの試算: パスワードには偏りがある(理論値よりもエントロピーが低下)
		- Coverの試算: 英単語には偏りがある(理論値よりもエントロピーが低下)
		- **One-Time Password**: 一度だけ利用するパスワードを用いる
			- PFS(鍵が解読されても、解読された鍵を使えるのは一定期間のみで、それ以後はまた機密性が保たれる性質)を高める
			- hash関数を用いる方法と、*ハードウェアトークン*を用いた**時刻同期型**の方法がある
	- *所持するもの*による認証
	- *生体認証*
		- 万が一複製されると変更するのが難しいという欠点がある
	- *多要素認証*: 複数の方式を組み合わせる
	- IPアドレスやMACアドレスによるものは「認証」とはいわない(フィルタリング)
	- 考えられる脅威: *盗聴*、*改竄・ハイジャック*、*なりすまし*、*捏造*、*再送*
	- **Challenge/Responce認証**: 認証の際にサーバから乱数(*nonce*)を送り、hash値にnonceを含める
		- e.g. *CHAP*(Challenge Handshake Authentication Protocol) (↔ PAP(Password -): パスワードによる認証)
- **認可**(authorization): 「どのリソースにアクセスできるのか」を決定すること
	- ID連携: e.g. SAML(p.85-87), OpenID(p.87-89)
	- アクセス制御: 認証により特定された相手に、許可された操作しかできないようにする


## 第4章 PKI
*PKI*(Public Key Infrastructure): 公開鍵が誰のものかを確かめるための枠組み
- *トラストモデル*: 誰か(何か)が本物か確かめるモデル (p.94-95)
	- **Web of Trust**(信頼の輪)モデル: 「友達の友達は友達」
		- e.g. OpenPGP
		- 全体を集中して管理する主体が存在しないことが利点でも欠点でもある
	- **認証局モデル**: 信頼できる第三者機関(= *認証局*(CA, certification authority))が保証
		- *EV SSL証明書*: 毎年の外部監査を受けた主体にのみ認証局が発行する
- 証明書の失効 (p.113-115)
	- 秘密鍵が紛失、漏洩した場合や、登録情報が変更された場合に必要になる
	- *CRL*モデル: *証明書失効リスト*(CRL, Certification Revocation List)をCAが発行
	- *OCSP*モデル: リアルタイムにOCSPサーバへ証明書が失効しているか問い合わせる


## 第5章 セキュリティプロトコル
- **SSL/TLS** (p.121-139)
	- Handshakeプロトコル: 通信相手とのセッションを確立
	- ChangeCipherSpecプロトコル: Handshakeプロトコルで合意した暗号化通信へ切り替える
	- Recordプロトコル: 実際のデータのやりとりを行う
	- Alertプロトコル: 異常があれば通知する
- **IPsec** (p.139-149)
	- AH: IPパケットの真正性と完全性を確保
	- ESP: IPパケットの機密性を確保


## 第7章 ネットワークセキュリティ
### ファイアウォール
ポリシーに基づいてパケットを監視
- *侵入検知システム*(IDS): 攻撃パターンのDBに基づいてネットワーク上の攻撃を検知するシステム
- *侵入防御システム*(IPS): IDS+検知した攻撃を遮断

### ブルートフォース攻撃
あるIDに対して、パスワードを総当りで試す
- 回数制限などでロックアウトできる
- **逆**ブルートフォース攻撃: あるパスワードに対して、IDを総当りで試す
	- *対処できない!*

### マルウェア
- ポリモーフィック型マルウェア: プログラムの一部を暗号化し、感染の度に鍵を変える
- メタモーフィック型マルウェア: 感染の度に命令の順序を書き換える

### ウイルス検出手法
- *コンペア手法*: 感染の前後でファイルのハッシュ値などを比較
- *パターンマッチング手法*: DBに登録されたパターンと類似しているか比較
- *ヒューリスティック手法*: 実際のOS上でプログラムを動作させずに検査
	- 静的ヒューリスティック: マルウェア特有の命令の並びがないか検査
	- 動的ヒューリスティック: 仮想環境上で動作させて検査
- *ビヘイビア手法*: 不正なシステムコールを監視して、実行を阻止する


## 第8章 Webセキュリティ
- Basic/Digest認証: SSLのない環境で用いるのは危険
- XSS
- SQLインジェクション
- *CSRF*: 攻撃者が用意したサイトを閲覧中に、閲覧者が意図しない別のサイト上での操作を実行させる
